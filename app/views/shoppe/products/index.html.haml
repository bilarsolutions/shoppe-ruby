- @page_title = "Products"

= content_for :header do
  %p.buttons= link_to "New product", :new_product, :class => 'button green'  
  %h2.products Products

.table
  %table.data
    %thead
      %tr
        %th{:width => '20%'} SKU
        %th{:width => '50%'} Name
        %th{:width => '15%'} Price
        %th{:width => '15%'} Stock
    %tbody
      - if @products.empty?
        %tr.empty
          %td{:colspan => 4} No products to display.
      - else
        - for category, products in @products
          %tr
            %th{:colspan => 4}= category.name
          - for product in products
            %tr
              %td= product.sku
              %td= link_to product.name, [:edit, product]
              %td= number_to_currency product.price
              %td
                - if product.stock_control?
                  %span.float-right= link_to "Edit", stock_level_adjustments_path(:item_type => product.class, :item_id => product.id), :class => 'edit', :rel => 'dialog2', :data => {:dialog_behavior => 'stockLevelAdjustments'}
                  = boolean_tag(product.in_stock?, nil, :true_text => product.stock, :false_text => 'No stock')
                - else
                  &#8734;
